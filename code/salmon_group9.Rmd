---
title: "Salmon Group Task"
author: "Ian Brunjes, Gavriella	Keyles, Dani Sclafani"
date: "2/3/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(here)
library(tidyverse)
library(janitor)
library(lubridate)
library(tsibble)
library(patchwork)
```

## Overview

This “Overview” section (above the tabs) should contain, in whatever order you choose: 

- An engaging image (with caption, including photo credit) that is relevant to the dataset
- A brief summary (3 - 4 sentences) of the dataset, and what is included in this “report”
- A map of the fish ladder location (you can make this in R on your own, or include an existing map appropriately licensed, with attribution)
- A professionally formatted data citation
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 


## Data Analysis {.tabset}

```{r}
# Read in salmon data from csv and clean names
salmon_data_full <- read_csv(here("data", "willamette_fish_passage.csv"))%>%
  clean_names()
```


### (Tab 1) Original Time Series 

This “Time series” tab should contain: 

- A finalized, static graph of adult passage for coho, jack coho, and steelhead salmon (you decide if these all occupy the same panel, or if they are in separate panels). Add a figure caption. Replace NA values with zero. 
- 2-3 bulletpoints summarizing major patterns / notable trends in the salmon passage time series data
-Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

```{r, warning=FALSE}
#initial wrangling, selecting for desired species, making sure salmon columns are numeric and NAs are replaced with 0. Also converting date column from a character class to a date character using lubridate package
tab1_data <- salmon_data_full %>% 
  select("steelhead", "coho", "jack_coho", "date") %>% 
  mutate_all(~replace(., is.na(.), 0)) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))

# creating column of total sum of salmon
tab1_data$salmon_sum <- rowSums(tab1_data[,1:3], na.rm = TRUE)

#making data into a time series using tsibble
tab1_ts <- tab1_data %>% 
  mutate(yearmonth = tsibble:: yearmonth(date)) %>% 
  as_tibble(key = NULL, index = yearmonth)
  
```


```{r, warning=FALSE}
# visualizing the time series data
#steelheads
sh_graph <- ggplot(data = tab1_ts, aes(x = yearmonth, y = steelhead ))+
  geom_line() +
  labs(x = " ", y = "Steelhead")+
  theme_minimal()

sh_graph

#coho
coho_graph <- ggplot(data = tab1_ts, aes(x = yearmonth, y = coho ))+
  geom_line()+
  labs(x = " ", y = "Coho")+
  theme_minimal()

# jack coho
jcoho_graph <- ggplot(data = tab1_ts, aes(x = yearmonth, y = jack_coho ))+
  geom_line()+
  labs(x = " ", y = "Jack Coho")+
  theme_minimal()

total_graph <- (jcoho_graph | coho_graph) / sh_graph

```

```{r, warning=FALSE,  fig.cap= "Figure 1: Jack Coho, Coho, and Steelhead salmon recorded monthly from January 2001 through December 2010 in  Willamette Falls."}

total_graph +plot_layout() + 
  plot_annotation(title = "Time Series of Jack Coho, Coho, and Steelhead Salmon")
```


### (Tab 2) Seasonplots {.tabset}

This “Seasonplots” tab should contain: 

- A finalized seasonplot for each species (coho, jack coho, steelhead). You can either facet, or use patchwork, to make the figure. Add a caption.
- Add 2-3 bulletpoints summarizing the major trends you see in the seasonplots.
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

### (Tab 3) Annual counts by species {.tabset}

This “Summary statistics and analysis” tab should contain: 

- A finalized figure of annual totals for fish passage, for each of the 3 species (coho, jack coho, steelhead). You decide if this is in a single panel, or multiple panels. Add a figure caption. 
- Add 2-3 bulletpoints summarizing major trends you see in the annual totals by species from 2000 - 2010.
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 
