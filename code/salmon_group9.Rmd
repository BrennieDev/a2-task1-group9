---
title: "Salmon Group Task"
author: "Ian Brunjes, Gavriella	Keyles, Dani Sclafani"
date: "2/3/2021"
output: 
  html_document: 
    css: bootstrap.css
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, cache = FALSE)

library(here)
library(tidyverse)
library(janitor)
library(lubridate)
library(scales)
```

## Overview

This “Overview” section (above the tabs) should contain, in whatever order you choose: 

- An engaging image (with caption, including photo credit) that is relevant to the dataset
- A brief summary (3 - 4 sentences) of the dataset, and what is included in this “report”
- A map of the fish ladder location (you can make this in R on your own, or include an existing map appropriately licensed, with attribution)
- A professionally formatted data citation
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 


## Data Analysis {.tabset}

### (Tab 1) Original Time Series 

```{r}
# Read in salmon data from csv and clean names
salmon_data_full <- read_csv(here("data", "willamette_fish_passage.csv"))%>%
  clean_names()
```

This “Time series” tab should contain: 

- A finalized, static graph of adult passage for coho, jack coho, and steelhead salmon (you decide if these all occupy the same panel, or if they are in separate panels). Add a figure caption. Replace NA values with zero. 
- 2-3 bulletpoints summarizing major patterns / notable trends in the salmon passage time series data
-Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

### (Tab 2) Seasonplots {.tabset}

This “Seasonplots” tab should contain: 

- A finalized seasonplot for each species (coho, jack coho, steelhead). You can either facet, or use patchwork, to make the figure. Add a caption.
- Add 2-3 bulletpoints summarizing the major trends you see in the seasonplots.
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

### (Tab 3) Annual counts by species {.tabset}

This “Summary statistics and analysis” tab should contain: 

- A finalized figure of annual totals for fish passage, for each of the 3 species (coho, jack coho, steelhead). You decide if this is in a single panel, or multiple panels. Add a figure caption. 
- Add 2-3 bulletpoints summarizing major trends you see in the annual totals by species from 2000 - 2010.
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

<<<<<<< HEAD
```{r, fig.align="center"}
=======
```{r}
>>>>>>> 2bfb0e423522909393c46a779ee3d6b70c6ef498

# clean the data for this part of anaylsis by selecting for desired species, pivoting to long format

tab3_data <- salmon_data_full %>% 
  select("steelhead", "coho", "jack_coho", "date") %>% 
  drop_na() %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = lubridate::year(date)) %>% 
  select(!date) %>% 
  pivot_longer(1:3, names_to = "species", values_to = "count") %>% 
  uncount(count) %>% 
  mutate(species = str_to_sentence(species)) %>% 
  mutate(species = str_replace(species, "Jack_coho", "Jack Coho")) %>% 
  mutate(year = as.Date(as.character(year),format = "%Y"))

# set some colors for plotting

salmon_colors = c("coral", "gray75", "salmon")

# make a plot

ggplot() +
  geom_bar(data = tab3_data, aes(x = year, group = species, fill = species), stat="count", position = "dodge") +
  facet_wrap(~species, scales = "free_y") +
  theme_minimal() +
  scale_fill_manual(values = salmon_colors) +
  labs(fill = "Species",
       title = "Annual Salmon Counts by Species",
       y = "Count",
       x = "") +
  scale_y_continuous(labels = comma_format()) +
  scale_x_date(date_labels = "'%y") +
  theme(plot.title = element_text(hjust = 0.5))
  
```


