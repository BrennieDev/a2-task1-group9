---
title: "Salmon Group Task"
author: "Ian Brunjes, Gavriella	Keyles, Dani Sclafani"
date: "2/3/2021"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(here)
library(tidyverse)
library(janitor)
library(lubridate)
library(tsibble)
library(feasts)
library(patchwork)
```

## Overview

This “Overview” section (above the tabs) should contain, in whatever order you choose: 

- An engaging image (with caption, including photo credit) that is relevant to the dataset
- A brief summary (3 - 4 sentences) of the dataset, and what is included in this “report”
- A map of the fish ladder location (you can make this in R on your own, or include an existing map appropriately licensed, with attribution)
- A professionally formatted data citation
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 


## Data Analysis {.tabset}

```{r message = FALSE}
# Read in salmon data from csv and clean names
salmon_data_full <- read_csv(here("data", "willamette_fish_passage.csv"))%>%
  clean_names()
```


### (Tab 1) Original Time Series 

This “Time series” tab should contain: 

- A finalized, static graph of adult passage for coho, jack coho, and steelhead salmon (you decide if these all occupy the same panel, or if they are in separate panels). Add a figure caption. Replace NA values with zero. 
- 2-3 bulletpoints summarizing major patterns / notable trends in the salmon passage time series data
-Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

### (Tab 2) Seasonplots {.tabset}

This “Seasonplots” tab should contain: 

- A finalized seasonplot for each species (coho, jack coho, steelhead). You can either facet, or use patchwork, to make the figure. Add a caption.
- Add 2-3 bulletpoints summarizing the major trends you see in the seasonplots.
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 

```{r}
# Massage data for time series
season_data <- salmon_data_full %>%
  mutate_all(~replace(., is.na(.), 0)) %>% 
  mutate(datetime = mdy(date)) %>%
  mutate(coho = as.numeric(coho)) %>% 
  mutate(jack_coho = as.numeric(jack_coho)) %>% 
  mutate(steelhead = as.numeric(steelhead))

# Subset of ts for coho
coho_ts <- season_data %>% 
  select(datetime, coho) %>% 
  as_tsibble(key = NULL, index = datetime)

# Subset of ts for jack_coho
jack_coho_ts <- season_data %>% 
  select(datetime, jack_coho) %>% 
  as_tsibble(key = NULL, index = datetime)

# Subset of ts for steelhead
steelhead_ts <- season_data %>% 
  select(datetime, steelhead) %>% 
  as_tsibble(key = NULL, index = datetime)

# Build plots for each species
coho <- coho_ts %>% gg_season()
jack <- jack_coho_ts %>% gg_season()
steel <- steelhead_ts %>% gg_season()

# Display plots using patchwork
(coho/jack/steel) & theme_minimal() + theme(legend.position = "none")
```


### (Tab 3) Annual counts by species {.tabset}

This “Summary statistics and analysis” tab should contain: 

- A finalized figure of annual totals for fish passage, for each of the 3 species (coho, jack coho, steelhead). You decide if this is in a single panel, or multiple panels. Add a figure caption. 
- Add 2-3 bulletpoints summarizing major trends you see in the annual totals by species from 2000 - 2010.
- Remember: All code that you used to wrangle the data and prepare the graphs should be available to see if we click on the Code buttons. 
